ARG ALPINE_VERSION
FROM reachsh/haskell-build-artifacts AS build

FROM alpine:$ALPINE_VERSION
RUN apk add gmp

COPY --from=build /usr/bin/solc /usr/bin/solc
COPY --from=build /build/bin/reachc /usr/bin/reachc
COPY --from=build /usr/bin/z3 /usr/bin/z3
RUN chmod +x /usr/bin/reachc

WORKDIR /app
ENTRYPOINT ["/usr/bin/reachc"]
ARG REACHC_HASH
ENV REACHC_HASH="${REACHC_HASH}"
ENV REACH_GIT_HASH="${REACHC_HASH}"
